@model Arasan.Models.ImportPO

@{
    ViewData["Title"] = " Import Purchase Order ";
}   
<div class="row wrapper border-bottom page-heading">
      <div class="col-lg-12">
  <style>
        .newwidth{ width:90px; }
    </style>
        <ol class="breadcrumb">
          <li> <a href="#">Home</a> </li>
          <li> <a>Purchase</a> </li>
          <li class="active"> <strong>Import Purchase Order </strong> </li>
        </ol>
      </div>
    </div>
     <div class="wrapper-content ">
        <div class="row">
         <div class="col-lg-12">
          <div class="ibox float-e-margins">
            <div class="widgets-container">
              <h5 style="font-size:14px">Import Purchase Order</h5>
              <hr>

                    @using (Html.BeginForm("ImportPO", "ImportPO", FormMethod.Post))
                        {
                            @Html.AntiForgeryToken()
              <form>
			@*  <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Branch<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                    @Html.HiddenFor(C => C.BranchId)
                                                    @Html.HiddenFor(C => C.SuppId)
                                            @Html.DropDownListFor(C => C.Branch, Model.Brlst, new { @id = "ddlBranch", @Class = "form-control _select", @TabIndex = 1 ,@disabled="disabled"})<br />
                                                </div>
                                            </div>
                                        </div>
                                       
                                    </div>*@
									
									<div style="height:30px;"></div>
									 <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">PO No.<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                     @Html.TextBoxFor(C => C.PONo, new { @id = "PONo", @class = "form-control", @TabIndex = 1 ,@readonly=true})
                                            @Html.HiddenFor(C => C.ID)
                                            @Html.HiddenFor(C => C.BranchId)
                                            @Html.HiddenFor(C => C.SuppId)
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="inputName3" class="col-sm-4 control-label">PO Date<label class="Mandatory"></label></label>
                                               <div class="col-sm-8">
                                                     @Html.TextBoxFor(C => C.POdate, new { @id = "POdate", @class = "form-control", @TabIndex = 2 ,@readonly=true})<br/>
                                                </div>
												
                                               
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Quot. No.<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                   @Html.TextBoxFor(C => C.QuoteNo, new { @id = "QuoteNo", @class = "form-control", @TabIndex = 3 ,@readonly=true})
                                                </div>
                                            </div>
                                        </div>
										
                                       
                                    </div>
               <div class="row">
                      <div class="col-md-4">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Party Id<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                        @Html.DropDownListFor(C => C.Supplier, Model.Suplst, new { @id = "ddlSupplier", @Class = "form-control _select", @TabIndex = 4 })
                                                           @Html.HiddenFor(c=>c.statetype,new { @id="hdstate"})
                                                </div>
                                            </div>
                                        </div>
                                <div class="col-md-4">
                                    <div class="form-group">

                                        <label for="inputName3" class="col-sm-4 control-label">Currency<label class="Mandatory"></label></label>
                                        <div class="col-sm-8">
                                            @Html.DropDownListFor(C => C.Cur, Model.Curlst, new { @id = "ddlCur", @Class = "form-control _select", @TabIndex = 5 })
                                        </div>
                                    </div>
                                </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="inputName3" class="col-sm-4 control-label">Exchange Rate<label class="Mandatory"></label></label>
                                              
                                                      <div class="col-sm-8">
												   @Html.TextBoxFor(C => C.ExRate, new { @id = "ExRate", @class = "form-control", @TabIndex = 6 })<br/>
												</div>
                                               
                                            </div>
                                        </div>
                            </div>
                            <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Ref. No.<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                    @Html.TextBoxFor(C => C.RefNo, new { @id = "RefNo", @class = "form-control", @TabIndex = 7 })<br/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="inputName3" class="col-sm-4 control-label">Ref. Date<label class="Mandatory"></label></label>
                                              
                                                     <div class="input-group date form_date col-sm-8" data-date="" data-date-format="dd-M-yyyy" >
                                                         @Html.TextBoxFor(C => C.RefDate, new { @id = "RefDate", @class = "form-control", @TabIndex = 8,@readonly=true })
														<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span> <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span><br/>
													</div>
                                               
                                            </div>
                                        </div>
                                        </div>
                                 
									 
									 
									 
                                       
                                      @* <div class="col-md-6">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Credit / Debit Balance<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                    <input class="form-control" id="inputEmail3" placeholder="0.00" type="text">
                                                </div>
                                            </div>
                                        </div>*@
                                         
                                    
                                       
                                    
									@* 
                                    <div style="height:30px;"></div>
									 <div class="row">
                                       
                                       <div class="col-md-4">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Prepared by<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                    @Html.DropDownListFor(C => C.Recid, Model.RecList, new { @id = "ddlEnqRec", @Class = "form-control _select", @TabIndex = 10 })
                                                </div>
                                            </div>
                                        </div>
										<div class="col-md-4">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Conatct No.<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                                    <input class="form-control" id="inputEmail3" placeholder="Conatct No." type="text">
                                                </div> 
                                            </div>
                                        </div> 
                                    </div>
									*@
									
									 <div style="height:30px;"></div>
			 <div class="row">
			
			 
          <div class="col-lg-12" style="overflow-x:scroll; min-width:300px; min-height:200px;">
           
                    <table class="table table-striped table-hover">
                      <thead>
                        <tr>
                        @* <th>   Item Group</th>*@
                          <th> Item </th>
                      
                       
                          <th>Unit</th>
                          <th> Conversion. Factor </th>
                        <th> Order Qty </th>
                       
                                 <th>Rate </th>
                                <th> Amount</th>
                            @*     <th> Disc %</th>*@
                         
                                    <th>Total Amount</th>
                                    <th>Due date</th>
                                      @*<th>Purchase Type</th>*@
                        </tr>
                      </thead>
                      <tbody id="tbBooks">
                        @{

                                                            int i = 0;
                                                            int j = 1;
                                                            foreach (var item in Model.PoItem.ToList())
                                                            {
                                                                                                                                            <tr id="trBook@(i)" class="chkitemlst" style="height: 30px;border-bottom: 1px dashed #ddd;">
                                                                                                                                            @*<td>
                                                                                                                                            @Html.DropDownListFor(o => o.PoItem[i].ItemGroupId, Model.PoItem[i].ItemGrouplst, "Please Select", new { @class = "form-control _select newcss", @id = "ddlItemGrp" + i, style = "width: 170px;", onchange = "Grup_Change(this.value," + i + ")",disabled="disabled" })
                                                                                                                                        </td>*@
                                                                                                                                        <td>

                                                            @Html.DropDownListFor(o => o.PoItem[i].ItemId, Model.PoItem[i].Itemlst, "Please Select", new { @class = "form-control _select newcss", @id = "ddlItem" + i, style = "width: 170px;", onchange = "changeItem(this.value," + i + ")" })
                                                                                                                                        @Html.HiddenFor(o => o.PoItem[i].saveItemId)
                                                                                                                                            </td>
                                                                                                                                             
                                                                                                                                       
                                                                                                                                         <td>
                                                                                                                                            @Html.TextBoxFor(o => o.PoItem[i].Unit, new { @id = "txtUnit" + i, @class = "form-control", style = "width: 100px;" , @readonly = "readonly"})
                                                                                                                                        </td>
                                                                                                                                         <td>
                                                                                                                                            @Html.TextBoxFor(o => o.PoItem[i].Conversionfactor, new { @id = "txtConversionfactor" + i, @class = "form-control", style = "width: 100px;", @readonly = "readonly" })
                                                                                                                                        </td>
                                                                                                                                         <td>
                                                                                                                                            @Html.TextBoxFor(o => o.PoItem[i].Quantity, new { @id = "txtQuantity" + i, @class = "form-control", onkeydown = "return isNumeric2(event.keyCode,this.value)", style = "width: 100px;text-align:right", @onkeyup = "changeQty(this," + i + ")"})
                                                                                                                                        </td>
                                                                                                                                        
                                                                                                                                         <td>
                                                                                                                                            @Html.TextBoxFor(o => o.PoItem[i].rate, new { @id = "txtrate" + i, @class = "form-control", onkeydown = "return isNumeric2(event.keyCode,this.value)", style = "width: 100px;text-align:right", @onkeyup = "changeQty(this," + i + ")" })
                                                                                                                                        </td>
                                                                                                                                         <td>
                                                                                                                                          @Html.HiddenFor(o => o.PoItem[i].Isvalid, new { @id = "Isvalid" + i })
                                                                                                                                            @Html.TextBoxFor(o => o.PoItem[i].Amount, new { @id = "txtAmount" + i, @class = "form-control", onkeydown = "return isNumeric2(event.keyCode,this.value)", style = "width: 100px;text-align:right",@readonly="readonly"})
                                                                                                                                        </td>
                                                                                                                                        
                                                                                                                                         <td>
                                                                                                                                            @Html.TextBoxFor(o => o.PoItem[i].TotalAmount, new { @id = "txtTotalAmount" + i, @class = "form-control", onkeydown = "return isNumeric2(event.keyCode,this.value)", style = "width: 100px;text-align:right", @onkeyup = "changeQty(this," + i + ")" ,@readonly="readonly" })
                                                                                                                                        </td>
                                                                                                                                         <td>
                                                                                                                 <div class="input-group date form_date col-sm-8" data-date="" data-date-format="dd-M-yyyy" >
                                                                                                                   @Html.TextBoxFor(o => o.PoItem[i].Duedate, new { @id = "txtDuedate" + i, @class = "form-control", style = "width: 100px;",@readonly=true}) 
                                                                                                           <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span> <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                                                                                        </div> </td>
                                                                                                     <td>
                                                                                                                                            @Html.DropDownListFor(o => o.PoItem[i].Purtype, Model.PoItem[i].PURLst, "Please Select", new { @class = "form-control _select newcss", @id = "ddlPurtype" + i, style = "width: 170px;"})
                                                                                                                                        </td>
                                                                                                                                         <td>

                                                            <img onclick="removeRow(@(i));" src="../Images/delete.png" style="cursor:pointer" /> <input name="PoItem.Index" type="hidden" value="@(i)" />
                                                                                                            </td>
                                                                                                                                        </tr>


                                                             i = i + 1;
                                                             j = j + 1;
                                                            }
                                                        }
                      </tbody>
                    </table>
                 
          </div>
        </div>
                            <div class="row">
                                <div class="col-md-2" style="overflow-x:scroll; min-width:300px; min-height:300px;">

                                    @* <div class="ibox float-e-margins">*@

                                    <!-- / ibox-title -->
                                    @* <div id="demo3" class="ibox-content collapse in">
                                <div class="borderedTable">
                                <div class="table-scrollable">*@
                                    <table class="table table-striped table-hover" >
                                        <thead>
                                        </thead>
                                        <tbody id="tbBooks">
                                            @{


                                                <tr>
                                                    <th>Gross</th>
                                                    <td>

                                                        @Html.TextBoxFor(C => C.Gross, new { @id = "txtGross", @class = "form-control", @TabIndex = 2 ,onkeydown = "return isNumeric2(event.keyCode,this.value)",@readonly=true})
                                                    </td>
                                                </tr>
                                                
                                                <tr>
                                                    <th>Round</th>
                                                    <td>

                                                        @Html.TextBoxFor(C => C.Round, new { @id = "txtRound", @class = "form-control", @TabIndex = 2 ,onkeydown = "return isNumeric2(event.keyCode,this.value)" , @onkeyup = "changeTot(this)"})
                                                    </td>
                                                </tr>
                                               
                                               
                                                <tr>
                                                    <th>Net</th>
                                                    <td>

                                                        @Html.TextBoxFor(C => C.Net, new { @id = "txtNet", @class = "form-control", @TabIndex = 2,onkeydown = "return isNumeric2(event.keyCode,this.value)" ,@readonly=true})
                                                    </td>
                                                </tr>
                                                

                                            }


                                        </tbody>
                                    </table>
                                </div>
                             
                             



                            <div class="col-md-8">
                                <div class="tabs-container">
                                    <ul class="nav nav-tabs">
                                        @*<li class="active"><a href="#tab-1" data-toggle="tab">Despatch Address</a></li>*@
                                        <li class="active"><a href="#tab-1" data-toggle="tab">Despatch Address</a></li>
                                            <li><a href="#tab-2" data-toggle="tab">Docs to be collected</a></li>

                                    </ul>
                                    <div class="tab-content">


                                        <div class="tab-pane active" id="tab-1">

                                            <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-4 control-label">Payment Terms<label class="Mandatory"></label></label>
                                                <div class="col-sm-8">
                                            @Html.DropDownListFor(C => C.Paymentterms, Model.Paymenttermslst, new { @id = "ddlPaymentterms", @Class = "form-control _select", @TabIndex = 1 })<br />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="inputName3" class="col-sm-4 control-label">Delivery Terms<label class="Mandatory"></label></label>
                                              
                                                      <div class="col-sm-8">
												 @Html.DropDownListFor(C => C.delterms, Model.deltermlst, new { @id = "ddldelterms", @Class = "form-control _select", @TabIndex = 1 })<br/>
												</div>
                                               
                                            </div>
                                        </div>
                                    </div>
									
									<div style="height:30px;"></div>
									 <div class="row">
                                         <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="inputName3" class="col-sm-4 control-label">Despatch<label class="Mandatory"></label></label>
                                              
                                                      <div class="col-sm-8">
												 @Html.DropDownListFor(C => C.desp, Model.desplst, new { @id = "ddldesp", @Class = "form-control _select", @TabIndex = 1 })<br/>
												</div>
                                               
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="inputName3" class="col-sm-4 control-label">Warrenty terms<label class="Mandatory"></label></label>
                                              
                                                      <div class="col-sm-8">
												 @Html.DropDownListFor(C => C.warrantyterms, Model.warrantytermslst, new { @id = "ddlwarrantyterms", @Class = "form-control _select", @TabIndex = 1 })<br/>
												</div>
                                               
                                            </div>
                                        </div>
										</div>
                                       
                                       
                                       
									<div style="height:30px;"></div>
									 <div class="row">
                                        <div class="col-md-12">
                                            <div class="form-group">
                                            
                                                <label for="inputName3" class="col-sm-2 control-label">Narration<label class="Mandatory"></label></label>
                                                <div class="col-sm-10">
                                                    @Html.TextAreaFor(C => C.Narration, new { @id = "txtNarration", @class = "form-control", @TabIndex = 2 })
                                                </div>
                                            </div>
                                        </div>
                                      
                                        
                                  
                                    </div>
                                    </div>
                                      
                                      <div class="tab-pane" id="tab-2">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <div class="btn-group">
                                                            <p style="float:right;"> <input type="button" value="Add Row" onclick="AddRow()" class="btn sbold green" /></p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">


                                                    <div class="col-lg-12" style="overflow-x:scroll; min-width:300px; min-height:200px;">

                                                        <table class="table table-striped table-hover" id="dataTable">
                                                            <thead>
                                                                <tr>
                                                                    @* <th>   Item Group</th>*@
                                                                    <th> Document </th>


                                                                     
                                                                </tr>
                                                            </thead>
                                                            <tbody id="tbBooks1">
                                                                @{

                                                                    int b = 0;
                                                                     
                                                                    foreach (var item in Model.doclst.ToList())
                                                                    {
                                                                        <tr id="trBook1@(b)" class="chkitemlst1" style="height: 30px;border-bottom: 1px dashed #ddd;">
                                                                       
                                                                            <td>
                                                                                @Html.TextBoxFor(o => o.doclst[b].Collecdoc, new { @id = "txtCollecdoc" + b, @class = "form-control", onkeydown = "return isNumeric2(event.keyCode,this.value)", style = "width: 400px;"})
                                                                            </td>
                                                                           <td>
                                                                @Html.HiddenFor(o => o.doclst[b].Isvalid, new { @id = "Isvalid" + b })
                                                                                <img onclick="removeRow(@(b));" src="../Images/delete.png" style="cursor:pointer" /> <input name="doclst.Index" type="hidden" value="@(b)" />
                                                                        </td>
                                                                        </tr>


                                                                        b = b + 1;
                                                                        
                                                                    }
                                                                }
                                                            </tbody>
                                                        </table>

                                                    </div>
                                                </div>
                                    </div>
                            </div>
                            </div>
                            </div>
                            </div>
                        
									<div style="height:30px;"></div>
                <button type="submit" class="btn aqua m-t-xs bottom15-xs">Submit</button>
                            <button class="btn btn-danger" type="button" causesvalidation="false" onclick="location.href='@Url.Action("ListImportPO", "ImportPO")'">Cancel</button>
              </form>
              }
            </div>
          </div>
        </div>
         
        </div>
      </div>
<script>
    $(function () {
        $('._select').select2();
    });
      $('.form_date').datetimepicker({
     //   language:  'fr',
        weekStart: 1,
        todayBtn:  1,
    autoclose: 1,
    todayHighlight: 1,
    startView: 2,
    minView: 2,
    forceParse: 0
    });
  function removeRow(id) {
        var table = document.getElementById("dataTable");
        var rowCount = table.rows.length;
        var row = document.getElementById('trBook' + id);
        var j = 0;
        $('tr.chkitemlst1').each(function () {
            if ($(this).css('display') !== 'none') {
                j += 1;
            }
        });
        if (j > 1) {
            row.style.display = "none";
            document.getElementById('Isvalid' + id).value = "N";
        }
        else {
            alert("Cannot delete all the rows.")
        }
    }
     function changeItem(ItemId, i) {
        $.ajax({
            url: 'GetItemDetail',
            data: { "ItemId": ItemId },
            type: "GET",
            success: function (result) {
                
                document.getElementById("txtUnit" + i).value = result.unit;

                    document.getElementById("txtConversionfactor" + i).value = result.cf;
                document.getElementById("txtrate" + i).value = result.price;
            },
            error: function () {
                alert("Data Not Found");
            }
        });
    }
    function changeQty(_this, i) {
                

                       var j = 0;
                    var qty = 0;
                    var tot = 0;
                    var totfrieght = 0;
                    var totamt = 0;
                    var totamount = 0;
            var totpackamt = 0;
                    var qty = document.getElementById("txtQuantity" + i).value;
            
                    var up = document.getElementById("txtrate" + i).value;
    
                    var cf = document.getElementById("txtConversionfactor" + i).value;
          
                   
         
                    if (qty == "")
                        qty = 0;

                    if (up == "")
                        up = 0;

                    if (cf == "")
                        cf = 0;

                  

                    var tot = eval(qty) * eval(up) * eval(cf);
                    
            document.getElementById("txtAmount" + i).value = tot.toFixed(2);
                   


                    $('tr.chkitemlst').each(function () {
                        if ($(this).css('display') !== 'none') {
                           

                         var amt = $(this).find('#txtAmount' + j.toString()).val();
                            if (amt == "")
                        amt = 0;

                         totamt += eval(amt);
                          

                         

                              }
                        j += 1;
                    });

                var roundamount = Math.ceil(totamt);

            var round = eval(roundamount) - eval(totamt);
                    document.getElementById("txtGross").value = totamt.toFixed(2);
                   document.getElementById("txtNet").value = roundamount.toFixed(2);
            document.getElementById("txtRound").value = round.toFixed(2);
              
                document.getElementById("txtAmount").value = withDecimal(roundamount.toFixed(2));


         
    }

    function convertNumberToWords(amount) {
    var words = new Array();
    words[0] = '';
    words[1] = 'One';
    words[2] = 'Two';
    words[3] = 'Three';
    words[4] = 'Four';
    words[5] = 'Five';
    words[6] = 'Six';
    words[7] = 'Seven';
    words[8] = 'Eight';
    words[9] = 'Nine';
    words[10] = 'Ten';
    words[11] = 'Eleven';
    words[12] = 'Twelve';
    words[13] = 'Thirteen';
    words[14] = 'Fourteen';
    words[15] = 'Fifteen';
    words[16] = 'Sixteen';
    words[17] = 'Seventeen';
    words[18] = 'Eighteen';
    words[19] = 'Nineteen';
    words[20] = 'Twenty';
    words[30] = 'Thirty';
    words[40] = 'Forty';
    words[50] = 'Fifty';
    words[60] = 'Sixty';
    words[70] = 'Seventy';
    words[80] = 'Eighty';
    words[90] = 'Ninety';
    amount = amount.toString();
    var atemp = amount.split(".");
    var number = atemp[0].split(",").join("");
    var n_length = number.length;
    var words_string = "";
    if (n_length <= 9) {
        var n_array = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
        var received_n_array = new Array();
        for (var i = 0; i < n_length; i++) {
            received_n_array[i] = number.substr(i, 1);
        }
        for (var i = 9 - n_length, j = 0; i < 9; i++, j++) {
            n_array[i] = received_n_array[j];
        }
        for (var i = 0, j = 1; i < 9; i++, j++) {
            if (i == 0 || i == 2 || i == 4 || i == 7) {
                if (n_array[i] == 1) {
                    n_array[j] = 10 + parseInt(n_array[j]);
                    n_array[i] = 0;
                }
            }
        }
        value = "";
        for (var i = 0; i < 9; i++) {
            if (i == 0 || i == 2 || i == 4 || i == 7) {
                value = n_array[i] * 10;
            } else {
                value = n_array[i];
            }
            if (value != 0) {
                words_string += words[value] + " ";
            }
            if ((i == 1 && value != 0) || (i == 0 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Crores ";
            }
            if ((i == 3 && value != 0) || (i == 2 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Lakhs ";
            }
            if ((i == 5 && value != 0) || (i == 4 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Thousand ";
            }
            if (i == 6 && value != 0 && (n_array[i + 1] != 0 && n_array[i + 2] != 0)) {
                words_string += "Hundred and ";
            } else if (i == 6 && value != 0) {
                words_string += "Hundred ";
            }
        }
        words_string = words_string.split("  ").join(" ");
    }
    return words_string;
}
function withDecimal(n) {
    var nums = n.toString().split('.')
    var whole = convertNumberToWords(nums[0])
    if (nums.length == 2) {
        var fraction = convertNumberToWords(nums[1])
        return whole + ' ' + fraction;
    } else {
        return whole;
    }
}
    function AddRow() {
        
        
                AppendRow();
           
    }
 function AppendRow() {
        var index = $("#tbBooks1").children("tr").length;

        

        var doc = "<td><input class='form-control' id='txtCollecdoc" + index + "' name='doclst[" + index + "].Collecdoc'  style='width: 400px;' type='text'    /></td>";
    
       
        var removeCell = "<td><input id='Isvalid" + index + "' name='doclst[" + index + "].Isvalid' type='hidden' value='Y'><img  src='../Images/delete.png' onclick='removeRow(" + index + ");'  style='cursor:pointer' /><input name='DirLst.Index' type='hidden' value='" + index + "'  /></td>";

        var newRow = "<tr class='chkitemlst1'  style='height: 30px;border-bottom: 1px dashed #ddd;'  id='trBook" + index + "'>" + doc + removeCell + "</tr>";

        //alert(Packing);
        $("#tbBooks1").append(newRow);

        $(function () {
            $('._select').select2();
        });
    }
    
</script>