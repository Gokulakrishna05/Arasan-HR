@model Arasan.Models.PyroProduction
@{
    ViewData["Title"] = "Pyro Production  Entry";
    string tag = ViewContext.HttpContext.Request.Query["tag"];
    string shift = ViewContext.HttpContext.Request.Query["shift"];
  
}
<style>
    .newwidth {
        width: 120px;
    }

    .mandatory {
        color: red;
        position: relative;
        top: 2px;
        left: 5px;
    }

    a {
        outline: none;
        text-decoration: none;
        color: #000;
    }

        a:hover, a:active, a:focus {
            outline: none;
            text-decoration: none;
            color: #000;
        }

    .container {
        max-width: 960px;
    }

    .panel-default > .panel-heading {
        color: #333;
        background-color: #fff;
        border-color: #e4e5e7;
        padding: 0;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

        .panel-default > .panel-heading a {
            display: block;
            padding: 10px 15px;
        }

            .panel-default > .panel-heading a:after {
                content: "";
                position: relative;
                top: 1px;
                display: inline-block;
                /*    font-family: 'Glyphicons Halflings';*/
                font-style: normal;
                font-weight: 400;
                line-height: 1;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
                float: right;
                transition: transform .25s linear;
                -webkit-transition: -webkit-transform .25s linear;
            }

            .panel-default > .panel-heading a[aria-expanded="true"] {
                background-color: #49B6D6;
            }

                .panel-default > .panel-heading a[aria-expanded="true"]:after {
                    content: "\2212";
                    -webkit-transform: rotate(180deg);
                    transform: rotate(180deg);
                }

            .panel-default > .panel-heading a[aria-expanded="false"]:after {
                content: "\002b";
                -webkit-transform: rotate(90deg);
                transform: rotate(90deg);
            }

    .accordion-option {
        width: 100%;
        float: left;
        clear: both;
        margin: 15px 0;
    }

        .accordion-option .title {
            font-size: 20px;
            font-weight: bold;
            float: left;
            padding: 0;
            margin: 0;
        }

        .accordion-option .toggle-accordion {
            float: right;
            font-size: 16px;
            color: #AAB7B8;
        }

            .accordion-option .toggle-accordion:before {
                content: "Expand All";
            }

            .accordion-option .toggle-accordion.active:before {
                content: "Collapse All";
            }

    .panel-title a {
        background-color: #AAB7B8;
    }

    .panel-body table tr td {
        padding: 5px;
    }

    .panel-body table {
        /* font-size: 15px;*/
        font-weight: normal;
    }
</style>
<div class="row wrapper border-bottom page-heading">
    <div class="col-lg-12">

        <ol class="breadcrumb">
            <li> <a href="#">Home</a> </li>
            <li> <a>Production</a> </li>
            <li class="active"> <strong>Pyro Production  Entry</strong> </li>
        </ol>
    </div>
</div>
<div class="wrapper-content ">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="widgets-container">
                    <h5 style="font-size:14px">Pyro Production Entry</h5>
                    <hr>
                    @using (Html.BeginForm("PyroProduction", "PyroProduction", FormMethod.Post))
                        {
                            @Html.AntiForgeryToken()
                             <form>


                           
                               @* <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                                    <div class="panel panel-default">

                                        <div class="panel-heading" role="tab" id="headingWc">
                                            <h4 class="panel-title">
                                            <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseWC" aria-expanded="false" aria-controls="collapseWC">
                                                    View Work center Details
                                                </a>
                                            </h4>
                                        </div>
                                    <div id="collapseWC" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingWc">
                                            <div class="panel-body">

                                            <div class="row">
                                                
                                                <div class="col-md-6">
                                                    <div class="form-group">

                                                        <label for="inputName3" class="col-sm-4 control-label">Work Center <label class="mandatory"></label></label>
                                                        <div class="col-sm-8">
                                                            @Html.DropDownListFor(C => C.CLocation, Model.Wclst," -- Please Select -- ", new { @id = "ddleditWC", @Class = "form-control _select", @TabIndex = 1 ,@onchange="changewc(this.value)" })<br />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="inputName3" class="col-sm-4 control-label">Shift<label class="mandatory"> </label></label>
                                               <div class="col-sm-8">
                                                            @Html.DropDownListFor(C => C.Shift, Model.Shiftlst," -- Please Select -- ", new { @id = "ddleditShift", @Class = "form-control _select", @TabIndex = 1 ,onchange = "changeshift1(this.value)"})<br />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            </div>
                                        </div>





                                    </div>
                                </div>*@
                        


  <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">

                                        <label for="inputName3" class="col-sm-4 control-label">Supervisor<label class="mandatory"></label></label>
                                        <div class="col-sm-8">
                                            <h4>@Html.DisplayFor(C => C.Eng)</h4>
                                           <br />
                                                                                    @Html.HiddenFor(C => C.super)
                                                                                    @Html.HiddenFor(C => C.Branch)
                                         
                                        </div>
                                    </div>
                                </div>
                            <div class="col-md-6">
                                <div class="form-group">

                                    <label for="inputName3" class="col-sm-4 control-label">Work Center <label class="mandatory"></label></label>
                                    <div class="col-sm-8">
                                        @Html.HiddenFor(C => C.APID)
                           @Html.DropDownListFor(C => C.Location, Model.worklst," -- Please Select -- ", new { @id = "ddlLocation", @Class = "form-control _select", @TabIndex = 1 })<br />
<br>                                
</div>
                                </div>
                            </div>
                           
                        </div>
                          <div style="height:15px;"></div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group">

                                        <label for="inputName3" class="col-sm-4 control-label">Doc Id<label class="mandatory"> </label></label>
                                        <div class="col-sm-8">
                                                                       @Html.TextBoxFor(C => C.DocId, new { @id = "txtDocId", @class = "form-control", @TabIndex = 1,@readonly="readonly" })<br />

                                           
                                            </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">

                                     <label for="inputName3" class="col-sm-4 control-label">Doc Date<label class="mandatory">*</label></label>
                                        <div class="input-group date form_date col-sm-8" data-date="" data-date-format="dd-M-yyyy">
                                            @Html.TextBoxFor(C => C.Docdate, new { @id = "Docdate", @class = "form-control", @TabIndex = 2,@size="32",@readonly=true })
                                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span> <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                       
                           @* <div id="divshiftgenerate">*@
                         <div style="height:15px;"></div>
                          <div class="row">
                          
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputName3" class="col-sm-4 control-label">Shift<label class="mandatory"> </label></label>

                                    <div class="col-sm-8">
                                            @Html.DropDownListFor(C => C.Shift, Model.Shiftlst," -- Please Select -- ", new { @id = "ddlShift", @Class = "form-control _select", @TabIndex = 1 ,onchange = "changeshift(this.value);"})<br />
                                            <br>
                                        </div>
                                </div>
                            </div>
                              <div class="col-md-6">
                                <div class="form-group">
                                    <label for="inputName3" class="col-sm-4 control-label">Shift Details<label class="Mandatory"></label></label>

                                    <div class="col-sm-8">
                                       <span style="color:green;font-size: 14px;"> <label id="shiftdetails"></label></span><br/>
                                    </div>
                                </div>
                            </div>
                        </div>
                       
                         
                        
                       
                
                
                       
                           
                    
              
                         @*   <div class="col-lg-10" hidden id="go">*@
                                <div class="col-lg-10"></div>
                                  <button type="submit" class="btn aqua m-t-xs bottom15-xs" id="btnSave" >Submit</button>
                         @*   <button type="submit" class="btn aqua fancybox"  data-fancybox-type='iframe' id="btnSave">Submit</button>*@
                                    <button class="btn btn-danger" type="button" causesvalidation="false" id="btnCansel" onclick="location.href='@Url.Action("PyroProduction", "PyroProduction")'">Cancel</button>
                            @*</div>*@
                           
</form>
 }
                
            </div>
        </div>`

    </div>
</div>

</div>
<script>
    $(function () {
        $('._select').select2();
        var shift = '@ViewBag.shift';
      changeshift(shift);
     
    });
    $('.form_date').datetimepicker({
        //   language:  'fr',
        weekStart: 1,
        todayBtn: 1,
        autoclose: 1,
        todayHighlight: 1,
        startView: 2,
        minView: 2,
        forceParse: 0
    });
    function changeshift(Shiftid) {
        $.ajax({
            url: 'GetshiftDetail',
            data: { "Shiftid": Shiftid },
            type: "GET",
            success: function (result) {
@*                alert(result);
*@                document.getElementById("shiftdetails").innerHTML = result.fromtime + " to " + result.totime + "  Total Hours : " + result.tothrs;
            },
            error: function () {
                alert("Data Not Found");
            }
        });


         

    }
   function changeshift1(Shiftid) {
        var wcid=document.getElementById("ddlLocation").value;
        $.ajax({
            url: 'GetWcRec',
            data: { "wcid": wcid ,"shift" : Shiftid},
            type: "POST",
            success: function (result) {
               if (result.res == "No") {
                    window.location.href = "PyroProduction?tag="+ wcid + "&shift=" + Shiftid;
               }
               else{
                   window.location.href = "PyroProduction?id=" +result.url;
               }

            },
            error: function () {

            }
        });

    }
    function changeMachineItem(ItemId, i) {
        $.ajax({
            url: 'GetMachineDetail',
            data: { "ItemId": ItemId },
            type: "GET",
            success: function (result) {

                document.getElementById("txtMachineDes" + i).value = result.name;

                document.getElementById("txtMType" + i).value = result.type;

            },
            error: function () {
                alert("Data Not Found");
            }
        });
    }


    function outputsave(i) {

        var id = document.getElementById("hdapid").value;
        var ItemId = document.getElementById("ddlOutItem" + i).value;
        var drum = document.getElementById("ddldrumno" + i).value;
        var time = document.getElementById("txtFromTime" + i).value;
        var qty = document.getElementById("txtOutputQty" + i).value;
        var totime = document.getElementById("txtToTime" + i).value;
        $.ajax({
            url: 'SaveOutDetail',
            data: { "id": id, "ItemId": ItemId, "drum": drum, "time": time, "qty": qty, "totime": totime },
            type: "POST",
            success: function (result) {

            },
            error: function () {

            }
        });
    }


    function changeOutItem(ItemId, i) {
        $.ajax({
            url: 'GetOutItemDetail',
            data: { "ItemId": ItemId },
            type: "GET",
            success: function (result) {

                document.getElementById("txtOutBinId" + i).value = result.bin;
                document.getElementById("txtOutBin" + i).value = result.binid;

            },
            error: function () {
                alert("Data Not Found");
            }
        });
    }
    function changeconsItem(ItemId, i) {
        $.ajax({
            url: 'GetConItemDetail',
            data: { "ItemId": ItemId },
            type: "GET",
            success: function (result) {

                document.getElementById("txtConsBinId" + i).value = result.bin;
                document.getElementById("txtConsBin" + i).value = result.binid;
                document.getElementById("txtconsunit" + i).value = result.unit;
                document.getElementById("txtconsunitid" + i).value = result.unitid;
            },
            error: function () {
                alert("Data Not Found");
            }
        });
    }
    function AddRow() {
        var opt = "";


        $.ajax({
            type: "POST",
            url: 'GetItemJSON',
            success: function (data) {
                $.each(data, function () {
                    opt += "<option value=" + this.value + ">" + this.text + "</option>";
                });


                AppendRow(opt);


            }
        })
    }
    function AddConsRow() {
        var opt = "";


        $.ajax({
            type: "POST",
            url: 'GetconsItemJSON',
            success: function (data) {
                $.each(data, function () {
                    opt += "<option value=" + this.value + ">" + this.text + "</option>";
                });


                AppendConsRow(opt);


            }
        })
    }
    function AddOutRow() {
        var opt = "";
        var remopt = "";

        $.ajax({
            type: "POST",
            url: 'GetOutItemJSON',
            success: function (data) {
                $.each(data, function () {
                    opt += "<option value=" + this.value + ">" + this.text + "</option>";
                });

                $.ajax({
                    type: "POST",
                    url: 'GetDrumJSON',
                    success: function (data) {
                        $.each(data, function () {
                            remopt += "<option value=" + this.value + ">" + this.text + "</option>";
                        });
                        AppendOutRow(opt, remopt);
                    }
                })

            }
        })
    }
    function PopulateDropDown(dropDownId, list) {
        //alert(list);
        $(dropDownId).empty().append('<option selected="selected" value="0">Please select</option>');
        if (list != null && list.length > 0) {
            $(dropDownId).removeAttr("disabled");
            $.each(list, function () {
                $(dropDownId).append($("<option></option>").val(this['value']).html(this['text']));
            });
        }
        $(dropDownId).trigger("liszt:updated");
    }

        function AddEmpRow() {
            var opt = "";
            $.ajax({
                type: "POST",
                url: 'GetEmpJSON',
                success: function (data) {
                    $.each(data, function () {
                        opt += "<option value=" + this.value + ">" + this.text + "</option>";
                    });
                    AppendEmpRow(opt);
                }
            })
        }
    function changeEmployeeItem(ItemId, i) {
        $.ajax({
            url: 'GetEmployeeDetail',
            data: { "ItemId": ItemId },
            type: "GET",
            success: function (result) {

                document.getElementById("txtEmpCode" + i).value = result.code;



            },
            error: function () {
                alert("Data Not Found");
            }
        });
    }
   
    @*  function Stk_Change(wcid) {
        $.ajax({
        url: 'GetStkItem',
        data: { 'wcid': wcid },
        type: "post",
        success: function (result) {
        var newlist;
        newlist = result.Itemlst;
        var j = 0;
        $('tr.chkitemlst').each(function () {
        if ($(this).css('display') !== 'none') {
        PopulateDropDown("#ddlItem" + j, result);
        }
        j += 1;
        });
        },
        error: function () {
        debugger;
        alert("Please Select State");
        }
        });
        }*@
        function changeentry(typeid) {
            if ($('#chkcmp').prop('checked') == true) {
                document.getElementById("go").style.display = "block";
            }
            else {
                document.getElementById("go").style.display = "none";
            }
        }
   
    function changewc(wcid) {
        @*var url = '@Url.Action("GetWcRec", "PyroProduction")?wcid=' + wcid;
        window.location.href = url;*@
        var shift=document.getElementById("ddlShift").value;
        $.ajax({
            url: 'GetWcRec',
            data: { "wcid": wcid ,"shift" : shift},
            type: "POST",
            success: function (result) {
               if (result.res == "No") {
window.location.href = "PyroProduction?tag="+ wcid + "&shift=" + shift;
               }
               else{
                   window.location.href = "PyroProduction?id=" +result.url;
               }

            },
            error: function () {

            }
        });
    }
</script>
<a class="fancybox1" rel="group" data-fancybox-type="iframe" href="#" style="display: none; width: 760px;"></a>
<a class="fancyboxe1" rel="group" data-fancybox-type="iframe" href="#" style="display: none; width: 760px;"></a>
<link rel="stylesheet" href="@Url.Content("~/css/jquery.fancybox.css?v=2.1.5")" type="text/css" media="screen" />
<script type="text/javascript" src="@Url.Content("~/css/jquery.fancybox.pack.js?v=2.1.5")"></script>
<script type="text/javascript">
    var fancybox123;
    jQuery(document).ready(function ($) {
        $(".fancybox").fancybox({
            width: '80%',
            height: '10%',
            arrows: false,

        });
        fancybox123 = $.fancybox;
    });
    function close_popup() {
        fancybox123.close();
        $(".fancybox1").fancybox({
            width: '100%',
            height: '100%',
            arrows: false,
        });
        $(".fancybox1").eq(0).trigger('click');
    }
</script>

